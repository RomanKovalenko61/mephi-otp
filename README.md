# Mephi OTP

Проект представляет собой Spring Boot REST сервис с интеграцией PostgreSQL, аутентификацией через JWT, генерацией OTP, отправкой почты через Gmail SMTP, SMS-сообщениями через SMPP и Telegram ботом.

## Функциональность

- **REST API**  
  Все эндпоинты доступны по контекстному пути `/springboot-rest` на порту `8088`. Можно изменить порт и префикс пути в `application.properties`.
Тестировать API можно с помощью Postman. Коллекция запросов для Postman сохранена в корне проекта (`mephi-otp.postman_collection.json`). Вот основные эндпоинты:
    - \`POST /springboot-rest/api/v1/auth/register\` — регистрация пользователя или админа. Админ может быть только один. 
    - \`POST /springboot-rest/api/v1/auth/login\` — получаем jwt токен необходимый для работы с приложением.
    - \`GET /springboot-rest/api/v1/otpconf\` — просмотр текущей конфигурации для генерации OTP кодов. Доступно только администратору.
    - \`POST /springboot-rest/api/v1/otp/generate\` — генерация ОТР кода. Код отправляется на email, SMS и Telegram в зависимости от настроек пользователя.
    - \`POST /springboot-rest/api/v1/otp/validate\` — проверка введённого OTP кода. Если код верный, то возвращается сообщение об успешном погашении кода, иначе вывод сообщения, что не так с данным кодом (например просрочен, неверный и т.д.).
    - \`GET /springboot-rest/api/v1/otp/{id}\` — просмотр кода и его доп информации по его идентификатору. Доступно только администратору
    - \`DELETE /springboot-rest/api/v1/otp/{id}\` — удаление кода по его идентификатору. Доступно только администратору.
    - \`POST /springboot-rest/api/v1/otpconf\` — изменение конфигурации генерации ОТР кодов. Доступно только администратору.
    - \`GET /springboot-rest/api/v1/admin/users/{id}\` — получение информации о пользователе по его идентификатору. Доступно только администратору.
    - \`GET /springboot-rest/api/v1/admin/users\` — получение информации о всех пользователях(кроме админов). Доступно только администратору.
    - \`PUT /springboot-rest/api/v1/admin/users/{id}\` — корректировка информации о пользователе по его идентификатору. Доступно только администратору.
    - \`DELETE /springboot-rest/api/v1/admin/users/{id}\` — удаление пользователя по его идентификатору. Доступно только администратору.

- **Аутентификация**  
  Используется JWT для генерации и проверки токенов с настроенным секретным ключом и временем истечения. Параметры JWT можно настроить в `application.properties`.

- **База данных**  
  PostgreSQL используется для хранения данных. Конфигурация подключения задается в `application.properties`.

- **OTP**  
  Генерация одноразовых паролей (OTP) заданной длины с определённым временем жизни. Параметры OTP можно настроить в `application.properties`.

- **Почта**  
  Отправка писем через SMTP сервер Gmail. Необходимо заменить `your_email` и `your_code_for_application` на актуальные данные.

- **SMS**  
  Отправка сообщений через локальный SMPP сервер с заданными параметрами.

- **Telegram**  
  Отправка уведомлений через Telegram бот. Обновите `telegram.bot.token` и `telegram.chat.id` с актуальными значениями.

## Сборка и запуск

1. **Требования**
    - Java 11 и выше
    - Maven
    - PostgreSQL

2. **Сборка проекта**

   Выполните в терминале:
   ```bash
   mvn clean install
   
3. **Запуск приложения**

   Запустите приложение с помощью команды:
   ```bash
   mvn spring-boot:run
   ```
4. **Проверка работы**

   После запуска приложения, вы можете проверить работоспособность эндпоинтов с помощью Postman.
Для этого создана коллекция `mephi-otp.postman_collection.json` (в корне проекта), которую можно импортировать в Postman.